<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Game</title>
    <style>
        html, body {
            --transitionTime: 2s;
            width: 100%;
            height: 100%;
            transition: all var(--transitionTime);
            
        }
        button {
            background-color: #04AA6D;
            border-radius: 5px;
            font-size: 17px;
            padding: 6px 18px;
        }
        .game-container {
            text-align: center;
            transition: all var(--transitionTime);
        }
        .math-container {
            /* animation: fadeOut 5s; */
            opacity: 1;
            justify-content: center;
            display: flex;
            transition: opacity .5s ease-in-out;

        }
        .math-container.hidden {
            opacity: 0;
            transition: opacity 3s ease-in-out; /* fades out for five seconds, fades back in depending on transition on .math-container */
        }
        .answer-container {
            
        }
        .answer-option-container {
            display: flex;
            margin-top: 10px;
            justify-content: center;
            transition: all var(--transitionTime);
        }
        .level-container {
            display: flex;
            margin-bottom: 10px;
            justify-content: center;
            gap: 2px;
        }
        .level-tile {
            border: 1px solid #8080803d;
            width: 49px;
            height: 49px;
            line-height: 53.75px;
            background: transparent;
            color: black;
            font-size: 25px;
            /* margin-right: 5px; */
            box-sizing: border-box;
        }
        .level-one-tile {
            background: yellow;
        }
        .level-two-tile {
            background: orange;
        }
        .level-three-tile {
            background: blue;
        }
        .level-four-tile {
            background: purple;
        }
        .level-five-tile {
            background: green;
        }
        .tile {
            width: 98px;
            height: 98px;
            line-height: 107.5px;
            background: grey;
            text-align: center;
            color: white;
            font-size: 50px;
            margin-right: 10px;
            box-sizing: border-box;
            transition: all var(--transitionTime);
        }
        .correct {
            /* box-sizing: border-box; */
            /* outline: 2px solid goldenrod; */
            background: goldenrod;
            border-radius: 50%;
            outline: 2px solid black;
            transition: all var(--transitionTime);

        }
        .false {
            color: red;
            transition: all var(--transitionTime);
            text-decoration: line-through;
        }
        .answer-option-hover:hover {
            background: lightgrey;
            cursor: pointer;
            transition: all var(--transitionTime);
        }
        .operator-container {
            
        }
        .number-container {
            /* 72274789 */
        }
        /* #mydiv {
            position: absolute;
            cursor: move;
            z-index: 10;
        } */

        /* on mobile where there is no hover, this makes it so the color doesn't change onClick and get stuck in the 'hover' state */
        @media (hover: none) {
            .answer-option-hover:hover {
                background: grey;
            }

}
    </style>
</head>
<div>
    <div class="game-container">
        <button name="start" type="button" onClick="init()">Start</button>
        <h1>Math Game</h1>
        <h2>Score: <span class="score">0000</span></h2>
        <h2>Level: <span class="level">1</span></h2>
        <!-- <select name="name" class="input-container">
            <option class="tile"></option>
            <div class="tile"></div>
            <div class="tile"></div>
            <div class="tile"></div>
            <div class="tile"></div>
        </select> -->
        <div class="level-container">
            <div class="level-tile"></div>
            <div class="level-tile "></div>
            <div class="level-tile "></div>
            <div class="level-tile "></div>
            <div class="level-tile "></div>
        </div>
        <div class="math-container">
            <div class="number-container tile"></div>
            <div class="operator-container tile">+</div>
            <div class="number-container tile"></div>
            <div id="mydiv" class="equal-container tile">=</div>
            <div 
            class="answer-container tile">???</div>
        </div>
        <div class="answer-option-container">
            <div class="answer-option-hover answer-option tile"></div>
            <div class="answer-option-hover answer-option tile "></div>
            <div class="answer-option-hover answer-option tile "></div>
            <div class="answer-option-hover answer-option tile "></div>
            <div class="answer-option-hover answer-option tile "></div>
        </div>
    </div>
</div>
    <script>
        //check the score
        //for each correct answer for a level fill in a block
        //make it a different color for each level
        //
        function scoreProgress(score) {
            for (let i = 0; i < score%6; i++) {
                console.log(score);
            //     console.log(levelTiles[i]);   
            //     console.log(score%6); 
            //     levelTiles[i].style.backgroundColor = 'blue';
            //     if(score > 5) {
            //         levelTiles[i].style.backgroundColor = 'orange';
            // }
            //     if(score > 10) {
            //         levelTiles[i].style.backgroundColor = 'gold';
            // }
                    
                }
            
        }
        // dragElement(document.getElementById("mydiv"));
// console.log(e.target);
/*function dragElement(e) {
  var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
//   console.log(elmnt);
console.log(e.target);
  let elmnt = e.target;
 
    /* otherwise, move the DIV from anywhere inside the DIV:*/
    // elmnt.onmousedown = dragMouseDown;
  

  /*function dragMouseDown(e) {
    e = e || window.event;
    e.preventDefault();
    e.target.style.transition = 'all 0s'; //remove transition from clicked element
    e.target.style.position = 'absolute';
    // get the mouse cursor position at startup:
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    // call a function whenever the cursor moves:
    document.onmousemove = elementDrag;
  }*/

  /*function elementDrag(e) {
    e = e || window.event;
    e.preventDefault();
    // calculate the new cursor position:
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    // set the element's new position:
    elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
    elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
  }*/

//  function closeDragElement() {
    /* stop moving when mouse button is released:*/
//     document.onmouseup = null;
//     document.onmousemove = null;
//   }
// }
        
        let levelTiles = document.querySelectorAll(".level-tile");
        let answerOptions = document.querySelectorAll(".answer-option");
        let numbers = [];
        let answer = [];
        let myScore = 0;
        let myTotalScore = 0;
        let myLevelScore = 0;
        let myLevel = 0;
        let numberOfAnswers = 5;
        let falseAnswers = [];
        let minInput = 0;
        let maxInput = 2.5;
        //make different levels
        // levelTiles[0].style.backgroundColor = 'blue';
        // levelTiles[1].style.backgroundColor = 'blue';
        // levelTiles[2].style.backgroundColor = 'blue';
        // levelTiles[3].style.backgroundColor = 'blue';
        // levelTiles[4].style.backgroundColor = 'blue';
       function checkLevel(){ //level one
        if(myTotalScore >= 5){
            myLevel = 1;
            minInput = 0;
            maxInput = 2.5;
        }
        //level two
        if(myTotalScore >= 10){
            myLevel = 2;
            minInput = 1;
            maxInput = 5;}
        //level three
        if(myTotalScore >= 15){
            myLevel = 3;
            minInput = 15;
            maxInput = 10;
            
        }
        //level four
        if(myTotalScore >= 20){
            myLevel = 4;
            minInput = 1;
            maxInput = 25;

        }
        //level five
        if(myTotalScore >= 25){
            myLevel = 5;
            minInput = 1;
            maxInput = 50;
        }}
        //1. make a random number between 0 and 9 randomNumber(min, max);
                function randomNumber(min, max) {
                    const myNumber = Math.floor(Math.random() * ((max + 1) - min)) + min;
                    console.log(myNumber);
                    return myNumber;
                }
        //add answer check event listener to answer option tiles
        //2. check to see if number clicked on was the answer
                //add event listeners to option tiles
               function addListener(){
                   answerOptions.forEach(x => x.addEventListener('click', checkAnswer));
               }
                
            // answerOptions.forEach(x => x.addEventListener('mouseenter', dragElement));
                    
                function addE(e){
                      e.target.addEventListener('click', checkAnswer);
                }
                function removeE(e){
                   
                      e.target.removeEventListener('click', checkAnswer);

               }
        //when answer is selected remove event listener
        //render board
        //create problem
        //create answers
        //place problem on board
        //place answers on board
        //
        //
        //
        
        
        
        

//TO DO
//3. Check that there are no duplicate answers in the answer options
//4. Clear the board and make another round

//5. keep track of correct rounds
//6. clear track if incorrect 
// document.querySelectorAll('.answer-container')[0].innerHTML = 'none';
   
       function checkAnswer(e){
           let selectedAnswer = parseInt(e.target.innerHTML); //force to be a number
            console.log(selectedAnswer);
            console.log(typeof parseInt(selectedAnswer));
            console.log(answer[0]);
            removeE(e);
            // dragElement(e.target);
            if(selectedAnswer === answer[0]) {
//3.5 When correct add one to the score
                // alert('Correct!');
                //add id to element
                e.target.classList.add('correct');
                e.target.classList.remove('answer-option-hover');
                //this removes the .hidden class so the problem area will show up again
                document.querySelectorAll('.math-container').forEach(el => {
                el.classList.remove('hidden');
            })
                myTotalScore++;
                myLevelScore++;
                document.querySelectorAll('.score')[0].innerHTML = myTotalScore;
                document.querySelectorAll('.level')[0].innerHTML = myLevel;
                if(myTotalScore < 6) {
                    levelTiles[myTotalScore - 1].style.backgroundColor = 'yellow';
                }
                if(myTotalScore === 6) {
                    myLevelScore = 1;
                }
                if(myTotalScore === 11) {
                    myLevelScore = 1;
                }
                if(myTotalScore === 16) {
                    myLevelScore = 1;
                }
                if(myTotalScore === 21) {
                    myLevelScore = 1;
                }
                if(myTotalScore === 25) {
                    // myLevelScore = 1;
                    document.querySelectorAll('.score')[0].innerHTML = 'WINNER!';
                    document.querySelectorAll('.level')[0].innerHTML = 'WINNER!';
                }
                if(myTotalScore > 5 && myTotalScore < 11) {
                    levelTiles[myLevelScore - 1].style.backgroundColor = 'orange';
                }
                if(myTotalScore > 10 && myTotalScore < 16) {
                    levelTiles[myLevelScore - 1].style.backgroundColor = 'blue';
                }
                if(myTotalScore > 15 && myTotalScore < 21) {
                    levelTiles[myLevelScore - 1].style.backgroundColor = 'purple';
                }
                if(myTotalScore > 20 && myTotalScore < 26) {
                    levelTiles[myLevelScore - 1].style.backgroundColor = 'green';
                }
                setTimeout(init, 800);
                // e.target.classList.add('answer-option-hover');
                // init();
                
            } else {
                // alert('FALSE!!!!')
                e.target.classList.add('false');
                e.target.classList.remove('answer-option-hover');
                
            }
        }
        // make two random numbers and add them together
        function clearStyling(){
            //this adds the .hidden class so the problem area will slowly fade away
            document.querySelectorAll('.math-container').forEach(el => {
                el.classList.add('hidden');
            })
            document.querySelectorAll('.answer-option').forEach(el => {
                el.classList.add('answer-option-hover');
                el.classList.remove('false');
                el.classList.remove('correct');
            })
        }
        function makeProblem(){
            answer = [];
            numbers = [];
            console.log(answer);
            document.querySelectorAll('.number-container').forEach( item => {
                let number = randomNumber(minInput, maxInput);
                console.log("this is number ", number);
                item.innerHTML = number;
                console.log(number);
                numbers.push(number);
                console.log(number);
            })
            console.log(numbers);
            answer.push(numbers[0] + numbers[1]);
            console.log(answer);
            // document.getElementsByClassName('answer-container')[0].innerHTML = answer[0];
        }
        //make random numbers for the options
        function makeOptions(){
            //make numbers and put into an array falseAnswers
            
            makeProblem();
            falseAnswers = [];
            for (let i = 0; i < numberOfAnswers; i++) {             
                let firstNumber = randomNumber(minInput, maxInput);
                let secondNumber = randomNumber(minInput, maxInput);
                let falseAnswer = firstNumber + secondNumber;
                //below while loop checks to make sure there are not duplicate options
                while(falseAnswer === answer[0]||falseAnswers.includes(falseAnswer)){
                    firstNumber = randomNumber(minInput, maxInput);
                    secondNumber = randomNumber(minInput, maxInput);
                    falseAnswer = firstNumber + secondNumber;
                }
                falseAnswers.push(falseAnswer);
            }
            placeCorrectAnswer(falseAnswers, answer);
            answerOptions.forEach((el, index) => {
                el.innerHTML = falseAnswers[index];
                //add click listener
                el.addEventListener('click', checkAnswer);
            })
        }
            //then take the real answer and put it into the array at a random spot
            // console.log(falseAnswers);
            //then go over the array and put those answers into the answer squares
            //     document.querySelectorAll('.answer-option').forEach(item => {
                //         //make random number
                //         //is that random number the same as the answer?
                //         // if so remake it
                //         if(falseAnswer === answer[0])
                //         //is that random number already used?
                
                //         {
                    //             firstNumber = randomNumber(minInput, maxInput);
                    //             secondNumber = randomNumber(minInput, maxInput);
                    //             falseAnswer = firstNumber + secondNumber;
                    //             falseAnswers.push(falseAnswer);
                    //             // item.innerHTML = falseAnswer;
                    //         } else {
                        //             if(falseAnswers.includes(falseAnswer)){
                            //                 firstNumber = randomNumber(minInput, maxInput);
                            //                 secondNumber = randomNumber(minInput, maxInput);
                            //                 falseAnswer = firstNumber + secondNumber;
                            //                 falseAnswers.push(falseAnswer);
                            //             }
                            //             item.innerHTML = falseAnswer;
                            //         }
        //         item.innerHTML = firstNumber + secondNumber;
        //     })
        // }
        //choose a random slot and put in the correct answer
        function placeCorrectAnswer(incorrectAnswers, correctAnswer){
            incorrectAnswers.splice(randomNumber(0, 4), 1, correctAnswer[0]);
            return incorrectAnswers;
        }
        

        function init(){
            // makeProblem();
            scoreProgress(myTotalScore);
            checkLevel();
            clearStyling();
            makeOptions();
            document.getElementsByName('start')[0].disabled = true;
            // placeCorrectAnswer(falseAnswers, answer);
            //reset answer-option styles
        }
        // init();
        function clearThis(){
            answerOptions.forEach(opt => opt.setAttribute('class', 'answer-option tile'));
            numbers = [];
            answer = [];
            falseAnswers = [];
        }
        
    </script>
</body>
</html>
