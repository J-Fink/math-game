<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Game</title>
    <style>
        html, body {
            --transitionTime: 1s;
            --equationTransitionTime: 3s;
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            transition: all var(--transitionTime);
            
        }
        * {
            box-sizing: border-box;
        }
        button {
            background-color: #04AA6D;
            border-radius: 5px;
            font-size: 17px;
            padding: 6px 18px;
        }
        button.hidden {
            visibility: hidden;
            background-color: #04AA6D;
            border-radius: 5px;
            font-size: 17px;
            padding: 6px 18px;
        }
        .pause-container {
            transition: all 2s ease-in-out;
            /* display: flex; */
            visibility: collapse;
            opacity: 0;
            height: 0;
            width: 0;
            /* transition: all 2s; */

        }
        .pause-content-container {
            width: 50%;
        }
        .unpaused {
            transition: all 2s ease-in-out;
            visibility: hidden;
        }
        .paused {
            transition: all 2s ease-in-out;
            opacity: 1;
            display: inline-block;
            visibility: visible;
            height: 100vh;
            width: 100vw;
            margin-top: 50vh;
            text-align: center;
            font-weight: bold;
            font-size: 4.5rem;

        }
        .game-container {
            display: block;
            margin-top: 12vh;
            text-align: center;
            transition: all var(--transitionTime);
            padding-left: 10px;
            padding-right: 10px;
            width: 100%;
            height: 100vh;
        }
        .game-container.hidden {
            visibility: hidden;
            margin-top: 12vh;
            text-align: center;
            /* transition: all var(--transitionTime); */
            padding-left: 10px;
            padding-right: 10px;
            width: 0;
            height: 0;

        }
        .math-container {
            /* animation: fadeOut 5s; */
            opacity: 1;
            justify-content: center;
            display: flex;
            transition: opacity .5s ease-in-out;

        }
        .math-container .tile:last-of-type {
            margin-right: 0;
        }
        .answer-option-container .tile:last-of-type {
            margin-right: 0;
        }
        .math-container.hidden {
            opacity: 0;
            transition: opacity var(--equationTransitionTime) ease-in-out; 
            /* fades out for ___ seconds, fades back in depending on transition on .math-container */
        }
        .answer-container {
            
        }
        .answer-option-container {
            display: flex;
            margin-top: 10px;
            justify-content: center;
            transition: all var(--transitionTime);
        }
        .level-container {
            display: flex;
            margin-bottom: 10px;
            justify-content: center;
            gap: 2px;
        }
        .level-tile {
            border: 1px solid #8080803d;
            width: 49px;
            height: 49px;
            line-height: 53.75px;
            background: transparent;
            color: black;
            font-size: 25px;
            /* margin-right: 5px; */
            box-sizing: border-box;
        }
        .level-one-tile {
            background: yellow;
        }
        .level-two-tile {
            background: orange;
        }
        .level-three-tile {
            background: blue;
        }
        .level-four-tile {
            background: purple;
        }
        .level-five-tile {
            background: green;
        }
        .tile {
            aspect-ratio: 1/1;
            width: 58px;
            /* height: 98px; */
            line-height: 1.5em;
            background: grey;
            text-align: center;
            color: white;
            font-size: 2.5rem;
            margin-right: 10px;
            box-sizing: border-box;
            transition: all var(--transitionTime);
        }
        .correct {
            /* box-sizing: border-box; */
            /* outline: 2px solid goldenrod; */
            background: goldenrod;
            border-radius: 50%;
            outline: 2px solid black;
            transition: all var(--transitionTime);
        }
        .answer-correct {
            background: goldenrod;
            transition: all var(--transitionTime);
            outline: 2px solid black;
        }
        .false {
            color: red;
            transition: all var(--transitionTime);
            text-decoration: line-through;
        }
        .answer-option-hover:hover {
            background: lightgrey;
            cursor: pointer;
            transition: all var(--transitionTime);
        }
        .operator-container {
            
        }
        .number-container {
            /* 72274789 */
        }
        /* #mydiv {
            position: absolute;
            cursor: move;
            z-index: 10;
        } */

        /* on mobile where there is no hover, this makes it so the color doesn't change onClick and get stuck in the 'hover' state */
        @media (hover: none) {
            .answer-option-hover:hover {
                background: grey;
            }

}
    </style>
</head>
<div>
    <div class="pause-container">
        <span class="pause-content-container">
            <div>Game Paused</div>
            <button name="resume" type="button" onClick="resume()">Resume</button>
        </span>
    </div>
    <div class="game-container">
        <button name="start" type="button" onClick="init()">Start</button>
        <button class="hidden" name="pause" type="button" onClick="pause()">Pause</button>
        <button name="restart" type="button" class="hidden" onClick="restart()">Restart</button>
        <h1>Math Game</h1>
        <h2>Score: <span class="score">0000</span></h2>
        <h2>Level: <span class="level">1</span></h2>
        <!-- <select name="name" class="input-container">
            <option class="tile"></option>
            <div class="tile"></div>
            <div class="tile"></div>
            <div class="tile"></div>
            <div class="tile"></div>
        </select> -->
        <div class="level-container">
            <div class="level-tile"></div>
            <div class="level-tile "></div>
            <div class="level-tile "></div>
            <div class="level-tile "></div>
            <div class="level-tile "></div>
        </div>
        <div class="math-container">
            <div class="number-container tile"></div>
            <div class="operator-container tile">+</div>
            <div class="number-container tile"></div>
            <div id="mydiv" class="equal-container tile">=</div>
            <div 
            class="answer-container tile">???</div>
        </div>
        <div class="answer-option-container">
            <div class="answer-option-hover answer-option tile"></div>
            <div class="answer-option-hover answer-option tile "></div>
            <div class="answer-option-hover answer-option tile "></div>
            <div class="answer-option-hover answer-option tile "></div>
            <div class="answer-option-hover answer-option tile "></div>
        </div>
    </div>
</div>
<script>
    let game = {
        isPaused: false,
        score: 0,
        totalScore: 0,
        levelScore: 0,
        level: 0,
        answer: [],
        prevAnswerLocation: '',
        prevAnswer: '',
        numberOfAnswers: 5,
        falseAnswers: [],
        minInput: 0,
        maxInput: 2.5,
        numbers: [],
    }
    let pauseContainer = document.querySelectorAll(".pause-container");
    let isPaused = false;
    const answerTile = document.getElementsByClassName('answer-container')[0];
    let levelTiles = document.querySelectorAll(".level-tile");
    let answerOptions = document.querySelectorAll(".answer-option");
    
        function restart() {
            game.score = 0;
            game.totalScore = 0;
            game.levelScore = 0;
            game.level = 0;
            game.minInput = 0;
            game.maxInput = 2.5;
            levelTiles.forEach(x => x.style.backgroundColor = 'white');
            document.querySelectorAll('.score')[0].innerHTML = 0;
            document.querySelectorAll('.level')[0].innerHTML = 0;
            document.getElementsByName('restart')[0].classList.add('hidden');
            document.querySelectorAll('.math-container')[0].classList.remove('hidden');
            setTimeout(init, 750);
        }
        function pause() {
            pauseContainer[0].classList.add('paused');
            document.getElementsByName('restart')[0].classList.remove('hidden');
            document.getElementsByClassName('game-container')[0].classList.add('hidden');
            console.log(game.isPaused);
            game.isPaused = !game.isPaused;
            console.log(game.isPaused);
        }
        function resume() {
            document.getElementsByName('restart')[0].classList.add('hidden');
            document.getElementsByClassName('game-container')[0].classList.remove('hidden');
            pauseContainer[0].classList.add('unpaused');
            pauseContainer[0].classList.remove('paused');
            document.querySelectorAll('.math-container')[0].classList.remove('hidden');
            setTimeout(init, 2500);
        }
        function scoreProgress(score) {
            for (let i = 0; i < score%6; i++) {
                // console.log(score);                   
                }    
        }
       
       
       
       function checkLevel(){ //level one
        if(game.totalScore >= 5){
            game.level = 1;
            game.minInput = 0;
            game.maxInput = 2.5;
        }
        //level two
        if(game.totalScore >= 10){
            game.level = 2;
            game.minInput = 1;
            game.maxInput = 5;}
        //level three
        if(game.totalScore >= 15){
            game.level = 3;
            game.minInput = 15;
            game.maxInput = 10;
            
        }
        //level four
        if(game.totalScore >= 20){
            game.level = 4;
            game.minInput = 1;
            game.maxInput = 25;

        }
        //level five
        if(game.totalScore >= 25){
            game.level = 5;
            game.minInput = 1;
            game.maxInput = 50;
        }}
        //1. make a random number between 0 and 9 randomNumber(min, max);
                function randomNumber(min, max) {
                    const myNumber = Math.floor(Math.random() * ((max + 1) - min)) + min;
                    // console.log(myNumber);
                    return myNumber;
                }
        //add answer check event listener to answer option tiles
        //2. check to see if number clicked on was the answer
                //add event listeners to option tiles
               function addListener(){
                   answerOptions.forEach(x => x.addEventListener('click', checkAnswer));
               }
                
            // answerOptions.forEach(x => x.addEventListener('mouseenter', dragElement));
                    
                function addE(e){
                      e.target.addEventListener('click', checkAnswer);
                }
                function removeE(e){
                   
                      e.target.removeEventListener('click', checkAnswer);

               }
        //when answer is selected remove event listener
        //render board
        //create problem
        //create answers
        //place problem on board
        //place answers on board
        //
        //
        //
        
        
        
        

//TO DO
//3. Check that there are no duplicate answers in the answer options
//4. Clear the board and make another round

//5. keep track of correct rounds
//6. clear track if incorrect 
// document.querySelectorAll('.answer-container')[0].innerHTML = 'none';
   
       function checkAnswer(e){
           let selectedAnswer = parseInt(e.target.innerHTML); //force to be a number
            // console.log(selectedAnswer);
            // console.log(typeof parseInt(selectedAnswer));
            // console.log(answer[0]);
            removeE(e);
            // dragElement(e.target);
            if(selectedAnswer === game.answer[0]) {
//3.5 When correct add one to the score
                // alert('Correct!');
                //add id to element
                e.target.classList.add('correct');
                e.target.classList.remove('answer-option-hover');
                //this removes the .hidden class so the problem area will show up again
                document.querySelectorAll('.math-container').forEach(el => {
                el.classList.remove('hidden');
            })
                game.totalScore++;
                game.levelScore++;
                document.querySelectorAll('.score')[0].innerHTML = game.totalScore;
                document.querySelectorAll('.level')[0].innerHTML = game.level;
                if(game.totalScore < 6) {
                    levelTiles[game.totalScore - 1].style.backgroundColor = 'yellow';
                }
                if(game.totalScore === 6) {
                    game.levelScore = 1;
                }
                if(game.totalScore === 11) {
                    game.levelScore = 1;
                }
                if(game.totalScore === 16) {
                    game.levelScore = 1;
                }
                if(game.totalScore === 21) {
                    game.levelScore = 1;
                }
                if(game.totalScore === 25) {
                    // myLevelScore = 1;
                    document.querySelectorAll('.score')[0].innerHTML = 'WINNER!';
                    document.querySelectorAll('.level')[0].innerHTML = 'WINNER!';
                }
                if(game.totalScore > 5 && game.totalScore < 11) {
                    levelTiles[game.levelScore - 1].style.backgroundColor = 'orange';
                }
                if(game.totalScore > 10 && game.totalScore < 16) {
                    levelTiles[game.levelScore - 1].style.backgroundColor = 'blue';
                }
                if(game.totalScore > 15 && game.totalScore < 21) {
                    levelTiles[game.levelScore - 1].style.backgroundColor = 'purple';
                }
                if(game.totalScore > 20 && game.totalScore < 26) {
                    levelTiles[game.levelScore - 1].style.backgroundColor = 'green';
                }
                // e.target.classList.remove('correct');
                // clearStyling();
                // clearAnswerStyling();
                // makeOptions();
                
                answerTile.innerHTML = game.answer[0];
                answerTile.classList.add('answer-correct');
                setTimeout(clearAnswerStyling, 2000);
                // setTimeout(init, 5000);
                // e.target.classList.add('answer-option-hover');
                // init();
                
            } else {
                // alert('FALSE!!!!')
                e.target.classList.add('false');
                e.target.classList.remove('answer-option-hover');
                
            }
        }
        // make two random numbers and add them together
        function clearAnswerStyling() {
            answerTile.classList.remove('answer-correct');
            answerTile.innerHTML = '???';
            document.querySelectorAll('.answer-option').forEach(el => {
                el.classList.add('answer-option-hover');
                el.classList.remove('false');
                el.classList.remove('correct');
            })
            setTimeout(init, 0);
        }
        function clearStyling(){
            //this adds the .hidden class so the problem area will slowly fade away
            document.querySelectorAll('.math-container').forEach(el => {
                el.classList.add('hidden');
            })
            // document.querySelectorAll('.answer-option').forEach(el => {
            //     el.classList.add('answer-option-hover');
            //     el.classList.remove('false');
            //     el.classList.remove('correct');
            // })
        }
        function makeProblem(){
            game.answer = [];
            game.numbers = [];
            // console.log(answer);
            document.querySelectorAll('.number-container').forEach( item => {
                let number = randomNumber(game.minInput, game.maxInput);
                // console.log("this is number ", number);
                item.innerHTML = number;
                // console.log(number);
                game.numbers.push(number);
                // console.log(number);
            })
            game.answer.push(game.numbers[0] + game.numbers[1]);
            while(game.answer[0] === game.prevAnswer) {
                game.answer = [];
                game.numbers = [];
                document.querySelectorAll('.number-container').forEach( item => {
                    let number = randomNumber(game.minInput, game.maxInput);
                    // console.log("this is number ", number);
                    item.innerHTML = number;
                    // console.log(number);
                    game.numbers.push(number);
                    // console.log(number);
                })
                game.answer.push(game.numbers[0] + game.numbers[1]);
            }
            // console.log(numbers);
            // console.log(`this is prev ${prevAnswer} this is current ${answer[0]}`);
            game.prevAnswer = game.answer[0];
            // console.log(answer);
            // document.getElementsByClassName('answer-container')[0].innerHTML = answer[0];
        }
        //make random numbers for the options
        function makeOptions(){
            //make numbers and put into an array falseAnswers
            
            makeProblem();
            game.falseAnswers = [];
            for (let i = 0; i < game.numberOfAnswers; i++) {             
                let firstNumber = randomNumber(game.minInput, game.maxInput);
                let secondNumber = randomNumber(game.minInput, game.maxInput);
                let falseAnswer = firstNumber + secondNumber;
                //below while loop checks to make sure there are not duplicate options
                while(falseAnswer === game.answer[0]||game.falseAnswers.includes(falseAnswer)){
                    firstNumber = randomNumber(game.minInput, game.maxInput);
                    secondNumber = randomNumber(game.minInput, game.maxInput);
                    falseAnswer = firstNumber + secondNumber;
                }
                game.falseAnswers.push(falseAnswer);
            }
            placeCorrectAnswer(game.falseAnswers, game.answer);
            answerOptions.forEach((el, index) => {
                el.innerHTML = game.falseAnswers[index];
                //add click listener
                el.addEventListener('click', checkAnswer);
            })
        }
           
        //choose a random slot and put in the correct answer
        function placeCorrectAnswer(incorrectAnswers, correctAnswer){
            let myRandomNumber = randomNumber(0, 4);
            while(game.prevAnswerLocation === myRandomNumber) {
                myRandomNumber = randomNumber(0, 4);
            }
            game.prevAnswerLocation = myRandomNumber;
            incorrectAnswers.splice(myRandomNumber, 1, correctAnswer[0]);
            return incorrectAnswers;
        }
        

        function init(){
            // makeProblem();
            document.getElementsByName('pause')[0].classList.remove('hidden');
            document.getElementsByName('restart')[0].classList.remove('hidden');
            clearStyling();
            document.getElementsByName('start')[0].classList.add('hidden');
            // clearAnswerStyling();
            makeOptions();
            scoreProgress(game.totalScore);
            checkLevel();
            document.getElementsByName('start')[0].disabled = true;
            // e.target.classList.remove('correct');
            // placeCorrectAnswer(falseAnswers, answer);
            //reset answer-option styles
        }
        // init();
        function clearThis(){
            answerOptions.forEach(opt => opt.setAttribute('class', 'answer-option tile'));
            game.numbers = [];
            game.answer = [];
            game.falseAnswers = [];
        }
        
</script>
</body>
</html>
